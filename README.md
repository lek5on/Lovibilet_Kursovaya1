# Изучение технологий разработки Telegram-ботов  
Проект:  LOVIBILET - Telegram-бот для поиска авиабилетов с использованием API Aviasales (TravelPayouts)

Это учебный/лабораторный репозиторий — реализация бота, создаваемая в процессе изучения технологий (Python, aiogram 3, aiohttp, aiosqlite, TravelPayouts API). Бот демонстрирует практические приёмы: асинхронное взаимодействие с внешним API, построение многошаговых диалогов через FSM, локальное хранение истории и подписок в SQLite и фоновый мониторинг цен.

> Внимание: данный репозиторий — учебный проект. Токены и секреты в репозитории отсутствуют либо заменены затычками. Для реальной эксплуатации обеспечьте безопасность ключей (переменные окружения, секретный менеджер, .env и т.п.).

## Содержимое репозитория
- `bot.py` — основной модуль бота, обработчики сообщений и callback'ов, FSM, фоновая задача проверки цен.
- `flights.py` — модуль взаимодействия с TravelPayouts API, модели данных и вспомогательные функции (поиск городов, получение цен, генерация ссылок).
- `db.py` — асинхронная работа с SQLite (инициализация БД, CRUD-операции для поисков и подписок).
- `config.py` — конфигурационные параметры (токены, интервал проверки, канал). Этот файл должен быть настроен локально и исключён из публичного репозитория.
- `requirements.txt` — перечисление зависимостей Python.

## Быстрый старт (локально)
Требования:
- Python 3.10+
- доступ в интернет (для работы с API TravelPayouts и Telegram)
- рекомендовано создать виртуальное окружение (venv)

1. Клонируйте репозиторий:
```bash
git clone https://github.com/azrafnurazim/kursovaya.git
cd kursovaya
```

2. Создайте виртуальное окружение и установите зависимости:
```bash
python -m venv .venv
source .venv/bin/activate   # Linux / macOS
.venv\Scripts\activate      # Windows
pip install -r requirements.txt
```

3. Настройте конфигурацию.
- Рекомендуется не сохранять токены в репозитории. Можно использовать `config.py` локально или переменные окружения.
- Пример (локальное редактирование `config.py`):
```python
TELEGRAM_TOKEN = "ВАШ_TELEGRAM_TOKEN"
TRAVELPAYOUTS_TOKEN = "ВАШ_TRAVELPAYOUTS_TOKEN"
CHECK_INTERVAL = 900           # интервал проверки подписок (в секундах)
CHANNEL_USERNAME = "Iovibilet" # имя канала без @
```
Или экспортируйте переменные окружения и измените код для чтения из `os.environ`.

4. Запуск бота:
```bash
python bot.py
```
При первом запуске база данных SQLite (`flights.db`) будет создана автоматически функцией инициализации.

## Как пользоваться
- В Telegram найдите бота (создайте через BotFather и укажите TELEGRAM_TOKEN в config).
- Отправьте `/start` и следуйте подсказкам меню.
- Можно:
  - выполнить поиск билета (пошагово выбрать страну → город → пассажиры → пересадки → дата),
  - оформить подписку на маршрут (бот будет уведомлять при падении цены ≥10%),
  - просмотреть список подписок и историю поисков,
  - удалить подписку (через кнопку или команду `/unsubscribe <id>`).


## Контакт / авторство 
Репозиторий: github.com/lek5on/Lovibilet_Kursovaya1
Автор: LEK5ON

